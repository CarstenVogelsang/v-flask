<!DOCTYPE html>
<html lang="de" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% block meta %}{% endblock %}

    <title>{% block title %}{{ get_betreiber().name if get_betreiber() else 'v-flask App' }}{% endblock %}</title>

    {# CSS: DaisyUI + Tailwind, Tabler Icons, v-flask.css #}
    {% block head_css %}
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.19/dist/full.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    {% set betreiber = get_betreiber() %}
    {% if betreiber and betreiber.google_fonts_url %}
    <link href="{{ betreiber.google_fonts_url }}" rel="stylesheet">
    {% endif %}
    <link rel="stylesheet" href="{{ url_for('v_flask_static.static', filename='tabler-icons/tabler-icons.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('v_flask_static.static', filename='css/v-flask.css') }}">
    {% endblock %}

    {# Dynamic Branding CSS Variables from Betreiber #}
    {% block branding_css %}
    {% set betreiber = get_betreiber() %}
    {% if betreiber %}
    <style>{{ betreiber.get_css_variables()|safe }}</style>
    {% endif %}
    {% endblock %}

    {# Additional CSS from child templates #}
    {% block extra_css %}{% endblock %}
</head>
<body class="min-h-screen flex flex-col bg-base-100">
    {% block body_start %}{% endblock %}

    {# Toast Container for Flash Messages #}
    {% block toast_container %}
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="toast toast-top toast-end z-50">
        {% for category, message in messages %}
        <div class="alert alert-{{ 'success' if category == 'success' else 'info' if category == 'info' else 'warning' if category == 'warning' else 'error' if category in ['error', 'danger'] else 'info' }}">
            <span>{{ message }}</span>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}
    {% endblock %}

    {# Main Content - Full page, no container #}
    {% block main %}
    <main class="flex-grow">
        {% block content %}{% endblock %}
    </main>
    {% endblock %}

    {# Modals #}
    {% block modals %}{% endblock %}

    {% block body_end %}{% endblock %}

    {# No JavaScript needed - DaisyUI components work without JS #}
    {% block scripts_base %}{% endblock %}

    {% block extra_js %}{% endblock %}
</body>
</html>
